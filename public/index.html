<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Brandynette Video Player - Port 6969</title>
  <style>
    /* BambiSleep Chat Styles */
    @import url("https://fonts.googleapis.com/css2?family=Audiowide&display=swap");

    :root {
      --primary-color: #0c2a2aE6;
      --primary-alt: #15aab5E6;
      --secondary-color: #40002fE6;
      --secondary-alt: #cc0174E6;
      --tertiary-color: #720241e6;
      --tertiary-alt: #02b893E6;
      --button-color: #df0471E6;
      --button-alt: #110000E6;
      --nav-color: #0a2626E6;
      --nav-alt: #17dbd8E6;
      --transparent: #124141E6;
      --error: #ff3333E6;
      --glow-pink: #ff00ff;
      --glow-cyan: #00ffff;
      --glow-purple: #8a2be2;
      --glass-bg: rgba(255, 255, 255, 0.08);
      --glass-border: rgba(255, 255, 255, 0.2);
      --bubble-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    body {
      margin: 0;
      padding: 0;
      font-family: 'Audiowide', monospace;
      background: radial-gradient(circle at 20% 80%, var(--primary-color) 0%, transparent 50%),
        radial-gradient(circle at 80% 20%, var(--secondary-color) 0%, transparent 50%),
        radial-gradient(circle at 40% 40%, var(--tertiary-color) 0%, transparent 50%),
        linear-gradient(135deg, #000011 0%, #001122 100%);
      min-height: 100vh;
      color: white;
      overflow-x: hidden;
    }

    .glass-bubble {
      background: var(--glass-bg);
      -webkit-backdrop-filter: blur(20px);
      backdrop-filter: blur(20px);
      border: 1px solid var(--glass-border);
      border-radius: 20px;
      box-shadow: var(--bubble-shadow), inset 0 1px 0 rgba(255, 255, 255, 0.1);
      position: relative;
      overflow: hidden;
    }

    .glass-bubble::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(135deg, rgba(255, 255, 255, 0.1) 0%, rgba(255, 255, 255, 0.05) 100%);
      pointer-events: none;
    }

    .glow-effect {
      filter: drop-shadow(0 0 10px var(--glow-cyan))drop-shadow(0 0 20px var(--glow-pink))drop-shadow(0 0 30px var(--glow-purple));
      animation: pulse-glow 3s ease-in-out infinite alternate;
    }

    @keyframes pulse-glow {
      0% {
        filter: drop-shadow(0 0 5px var(--glow-cyan))drop-shadow(0 0 10px var(--glow-pink));
      }

      100% {
        filter: drop-shadow(0 0 15px var(--glow-cyan))drop-shadow(0 0 25px var(--glow-pink))drop-shadow(0 0 35px var(--glow-purple));
      }
    }

    .bubble-button {
      background: linear-gradient(135deg, var(--button-color), var(--secondary-alt));
      color: white;
      border: 1px solid var(--glass-border);
      border-radius: 15px;
      padding: 0.6rem 1rem;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: 'Audiowide', sans-serif;
      -webkit-backdrop-filter: blur(10px);
      backdrop-filter: blur(10px);
      position: relative;
      overflow: hidden;
      margin: 0.2rem;
    }

    .bubble-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: left 0.5s;
    }

    .bubble-button:hover::before {
      left: 100%;
    }

    .bubble-button:hover {
      transform: translateY(-2px)scale(1.05);
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4), 0 0 20px var(--glow-pink);
    }

    .bubble-button.selected {
      background: linear-gradient(135deg, var(--glow-pink), var(--glow-cyan));
      box-shadow: 0 0 30px var(--glow-pink), inset 0 2px 10px rgba(255, 255, 255, 0.1);
    }

    .video-name {
      font-size: 0.65rem;
      opacity: 0.8;
      margin: 0;
      padding: 0;
    }

    .video-title {
      font-size: 0.8rem;
      margin: 0;
      padding: 0;
    }

    .compact-container {
      margin: 0.2rem;
      padding: 0.5rem;
    }

    .no-spacing {
      margin: 0;
      padding: 0;
      border: 0;
      outline: 0;
    }
  </style>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>

<body>
  <div id="root"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;

    // Download Status Component
    function DownloadStatus() {
      const [status, setStatus] = useState(null);
      const [loading, setLoading] = useState(true);

      useEffect(() => {
        const fetchStatus = async () => {
          try {
            const response = await fetch('/api/download-status');
            if (response.ok) {
              const data = await response.json();
              setStatus(data);
            }
          } catch (err) {
            console.error('Error fetching download status:', err);
          } finally {
            setLoading(false);
          }
        };

        // Initial fetch
        fetchStatus();

        // Poll every 2 seconds for updates
        const interval = setInterval(fetchStatus, 2000);

        return () => clearInterval(interval);
      }, []);

      if (loading || !status) {
        return null;
      }

      const hasActivity = status.stats.activeCount > 0 || status.stats.waitingCount > 0;

      if (!hasActivity) {
        return null; // Don't show if no downloads
      }

      return React.createElement('div', {
        className: 'glass-bubble glow-effect compact-container',
        style: {
          margin: '0.4rem',
          maxWidth: '1200px',
          marginLeft: 'auto',
          marginRight: 'auto'
        }
      },
        React.createElement('h3', {
          className: 'video-title',
          style: {
            textAlign: 'center',
            marginBottom: '1rem',
            color: 'var(--nav-alt)',
            fontSize: '1.2rem'
          }
        }, `üìä Download Status (${status.stats.activeCount}/${status.stats.maxConcurrent} Active)`),

        // Active Downloads
        status.stats.activeCount > 0 && React.createElement('div', {
          style: { marginBottom: '1rem' }
        },
          React.createElement('h4', {
            style: {
              color: 'var(--primary-alt)',
              fontSize: '0.9rem',
              marginBottom: '0.5rem'
            }
          }, 'üî• Currently Downloading:'),
          React.createElement('div', {
            className: 'glass-bubble',
            style: {
              padding: '0.5rem',
              background: 'rgba(0, 255, 255, 0.05)'
            }
          },
            status.active.map((download, index) =>
              React.createElement('div', {
                key: download.sessionId,
                style: {
                  padding: '0.3rem 0.5rem',
                  borderBottom: index < status.active.length - 1 ? '1px solid var(--glass-border)' : 'none',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center'
                }
              },
                React.createElement('span', {
                  style: {
                    color: 'var(--tertiary-alt)',
                    fontSize: '0.8rem',
                    fontWeight: 'bold'
                  }
                }, `üì• ${download.filename}`),
                React.createElement('span', {
                  style: {
                    color: 'var(--primary-alt)',
                    fontSize: '0.7rem',
                    opacity: 0.8
                  }
                }, `${download.duration}s`)
              )
            )
          )
        ),

        // Queue
        status.stats.waitingCount > 0 && React.createElement('div', null,
          React.createElement('h4', {
            style: {
              color: 'var(--secondary-alt)',
              fontSize: '0.9rem',
              marginBottom: '0.5rem'
            }
          }, `‚è≥ Queue (${status.stats.waitingCount} waiting):`),
          React.createElement('div', {
            className: 'glass-bubble',
            style: {
              padding: '0.5rem',
              background: 'rgba(255, 0, 255, 0.05)'
            }
          },
            status.waiting.map((item, index) =>
              React.createElement('div', {
                key: item.sessionId,
                style: {
                  padding: '0.3rem 0.5rem',
                  borderBottom: index < status.waiting.length - 1 ? '1px solid var(--glass-border)' : 'none',
                  display: 'flex',
                  justifyContent: 'space-between',
                  alignItems: 'center'
                }
              },
                React.createElement('span', {
                  style: {
                    color: 'var(--button-color)',
                    fontSize: '0.8rem'
                  }
                }, `#${item.position} - ${item.filename}`),
                React.createElement('span', {
                  style: {
                    color: 'var(--secondary-alt)',
                    fontSize: '0.7rem',
                    opacity: 0.8
                  }
                }, `waiting ${item.waitTime}s`)
              )
            )
          )
        )
      );
    }

    function VideoPlayer({ videoSrc, title }) {
      const [isPlaying, setIsPlaying] = useState(false);
      const [currentTime, setCurrentTime] = useState(0);
      const [duration, setDuration] = useState(0);
      const [volume, setVolume] = useState(1);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);

      const videoRef = React.useRef(null);

      useEffect(() => {
        const video = videoRef.current;
        if (!video) return;

        const handleLoadedMetadata = () => {
          setDuration(video.duration);
          setLoading(false);
        };

        const handleTimeUpdate = () => setCurrentTime(video.currentTime);
        const handlePlay = () => setIsPlaying(true);
        const handlePause = () => setIsPlaying(false);
        const handleEnded = () => setIsPlaying(false);
        const handleError = () => {
          setError('Failed to load video');
          setLoading(false);
        };

        video.addEventListener('loadedmetadata', handleLoadedMetadata);
        video.addEventListener('timeupdate', handleTimeUpdate);
        video.addEventListener('play', handlePlay);
        video.addEventListener('pause', handlePause);
        video.addEventListener('ended', handleEnded);
        video.addEventListener('error', handleError);

        return () => {
          video.removeEventListener('loadedmetadata', handleLoadedMetadata);
          video.removeEventListener('timeupdate', handleTimeUpdate);
          video.removeEventListener('play', handlePlay);
          video.removeEventListener('pause', handlePause);
          video.removeEventListener('ended', handleEnded);
          video.removeEventListener('error', handleError);
        };
      }, [videoSrc]);

      const togglePlay = () => {
        const video = videoRef.current;
        if (video.paused) {
          video.play();
        } else {
          video.pause();
        }
      };

      const handleSeek = (e) => {
        const video = videoRef.current;
        const rect = e.currentTarget.getBoundingClientRect();
        const percent = (e.clientX - rect.left) / rect.width;
        video.currentTime = percent * duration;
      };

      const handleVolumeChange = (e) => {
        const newVolume = parseFloat(e.target.value);
        setVolume(newVolume);
        videoRef.current.volume = newVolume;
      };

      const formatTime = (time) => {
        const minutes = Math.floor(time / 60);
        const seconds = Math.floor(time % 60);
        return `${minutes}:${seconds.toString().padStart(2, '0')}`;
      };

      if (error) {
        return React.createElement('div', { style: { color: 'red', padding: '2rem', textAlign: 'center' } }, error);
      }

      return React.createElement('div', {
        className: 'glass-bubble glow-effect',
        style: {
          padding: '0.8rem',
          margin: '0.4rem'
        }
      },
        React.createElement('div', {
          className: 'glass-bubble',
          style: { position: 'relative', background: 'black', overflow: 'hidden', margin: '0.3rem' }
        },
          React.createElement('video', {
            ref: videoRef,
            src: videoSrc,
            style: { width: '100%', height: 'auto', maxHeight: '70vh', display: 'block', cursor: 'pointer' },
            onClick: togglePlay
          }),
          loading && React.createElement('div', {
            style: {
              position: 'absolute',
              top: '50%',
              left: '50%',
              transform: 'translate(-50%, -50%)',
              color: 'white',
              textAlign: 'center'
            }
          }, 'Loading video...')
        ),
        React.createElement('div', {
          className: 'glass-bubble compact-container',
          style: {
            display: 'flex',
            alignItems: 'center',
            gap: '0.3rem',
            color: 'white'
          }
        },
          React.createElement('button', {
            onClick: togglePlay,
            disabled: loading,
            className: 'bubble-button glow-effect',
            style: {
              fontSize: '1.1rem'
            }
          }, isPlaying ? '‚è∏Ô∏è' : '‚ñ∂Ô∏è'),
          React.createElement('div', {
            style: {
              flex: 1,
              height: '8px',
              background: 'var(--button-alt)',
              borderRadius: 'var(--border-radius)',
              cursor: 'pointer',
              border: '1px solid var(--nav-alt)'
            },
            onClick: handleSeek
          },
            React.createElement('div', {
              style: {
                height: '100%',
                background: 'linear-gradient(90deg, var(--tertiary-alt), var(--primary-alt))',
                width: `${(currentTime / duration) * 100}%`,
                borderRadius: 'var(--border-radius)',
                transition: 'width 0.1s ease'
              }
            })
          ),
          React.createElement('span', { style: { fontSize: '0.9rem', fontFamily: 'monospace', minWidth: '80px' } },
            `${formatTime(currentTime)} / ${formatTime(duration)}`
          ),
          React.createElement('span', null, 'üîä'),
          React.createElement('input', {
            type: 'range',
            min: '0',
            max: '1',
            step: '0.1',
            value: volume,
            onChange: handleVolumeChange,
            style: { width: '80px' }
          })
        ),
        React.createElement('div', {
          className: 'no-spacing',
          style: { textAlign: 'center' }
        },
          React.createElement('h3', {
            className: 'video-title glow-effect'
          }, title)
        )
      );
    }

    function App() {
      const [videos, setVideos] = useState([]);
      const [publicFiles, setPublicFiles] = useState([]);
      const [loading, setLoading] = useState(true);
      const [error, setError] = useState(null);
      const [selectedVideo, setSelectedVideo] = useState(null);

      useEffect(() => {
        fetchData();
      }, []);

      const fetchData = async () => {
        try {
          setLoading(true);

          // Fetch videos
          const videosResponse = await fetch('/api/videos');
          if (!videosResponse.ok) throw new Error('Failed to fetch videos');
          const videosData = await videosResponse.json();
          setVideos(videosData.videos);

          // Fetch public files
          const publicResponse = await fetch('/api/public');
          if (!publicResponse.ok) throw new Error('Failed to fetch public files');
          const publicData = await publicResponse.json();
          setPublicFiles(publicData.files);

          // Auto-select first video
          if (videosData.videos.length > 0) {
            setSelectedVideo(videosData.videos[0]);
          }
        } catch (err) {
          console.error('Error fetching data:', err);
          setError('Failed to load data. Please try again.');
        } finally {
          setLoading(false);
        }
      };

      if (loading) {
        return React.createElement('div', {
          style: {
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            minHeight: '100vh',
            color: 'white',
            textAlign: 'center'
          }
        },
          React.createElement('div', {
            style: {
              width: '50px',
              height: '50px',
              border: '4px solid rgba(255,255,255,0.3)',
              borderTop: '4px solid white',
              borderRadius: '50%',
              animation: 'spin 1s linear infinite',
              marginBottom: '1rem'
            }
          }),
          React.createElement('p', null, 'Loading...')
        );
      }

      if (error) {
        return React.createElement('div', {
          style: {
            display: 'flex',
            flexDirection: 'column',
            alignItems: 'center',
            justifyContent: 'center',
            minHeight: '100vh',
            color: 'white',
            textAlign: 'center'
          }
        },
          React.createElement('h2', { style: { color: '#ff6b6b' } }, 'Oops! Something went wrong'),
          React.createElement('p', null, error),
          React.createElement('button', {
            onClick: fetchData,
            className: 'theme-button',
            style: {
              background: 'var(--button-color)',
              color: 'white',
              border: 'var(--border) var(--button-alt)',
              padding: '1rem 2rem',
              borderRadius: 'var(--border-radius)',
              cursor: 'pointer',
              fontFamily: 'Audiowide, sans-serif',
              fontSize: '0.9rem'
            }
          }, 'Try Again')
        );
      }

      return React.createElement('div', { style: { minHeight: '100vh', color: 'white' } },
        React.createElement('header', {
          className: 'glass-bubble glow-effect',
          style: {
            textAlign: 'center',
            padding: '0.5rem',
            margin: '0.2rem'
          }
        },
          React.createElement('h1', {
            style: {
              margin: '0 0 0.5rem 0',
              fontSize: '2.5rem',
              fontWeight: '700',
              textShadow: '2px 2px 4px rgba(0,0,0,0.5)',
              fontFamily: 'Audiowide, sans-serif',
              color: 'var(--nav-alt)',
              textTransform: 'uppercase',
              letterSpacing: '2px'
            }
          }, 'üé¨ Brandynette Video Player'),
          React.createElement('p', { style: { margin: 0, fontSize: '1.1rem', opacity: 0.9 } },
            `Premium video streaming on port 6969`)
        ),
        // Download Status Component
        React.createElement(DownloadStatus),
        React.createElement('main', {
          className: 'compact-container',
          style: { maxWidth: '1200px', margin: '0 auto' }
        },
          videos.length === 0
            ? React.createElement('div', { style: { textAlign: 'center', padding: '3rem 1rem' } },
              React.createElement('h2', { style: { color: '#ffd93d' } }, 'No videos found'),
              React.createElement('p', null, 'Please add video files to the BRANDIFICATION folder')
            )
            : React.createElement('div', null,
              videos.length > 1 && React.createElement('div', { style: { marginBottom: '2rem', textAlign: 'center' } },
                React.createElement('h3', { style: { marginBottom: '1rem' } }, 'Select a video:'),
                React.createElement('div', {
                  className: 'no-spacing',
                  style: { display: 'flex', flexWrap: 'wrap', justifyContent: 'center' }
                },
                  videos.map(video =>
                    React.createElement('button', {
                      key: video,
                      onClick: () => setSelectedVideo(video),
                      className: selectedVideo === video ? 'bubble-button selected glow-effect' : 'bubble-button',
                      style: {
                        fontSize: '0.7rem'
                      }
                    }, video)
                  )
                )
              ),
              selectedVideo && React.createElement(VideoPlayer, {
                videoSrc: `/videos/${selectedVideo}`,
                title: selectedVideo
              })
            ),
          React.createElement('div', {
            className: 'glass-bubble glow-effect compact-container',
            style: {
              textAlign: 'center'
            }
          },
            React.createElement('h3', {
              className: 'video-title'
            }, 'API Endpoints:'),
            React.createElement('div', {
              className: 'no-spacing',
              style: {
                display: 'grid',
                maxWidth: '600px',
                margin: '0 auto'
              }
            },
              React.createElement('p', { className: 'video-name' }, `üì∫ Videos: ${videos.length} found`),
              React.createElement('p', { className: 'video-name' }, `üìÅ Public files: ${publicFiles.length} found`),
              React.createElement('p', { className: 'video-name' }, 'üîó /api/videos - List videos'),
              React.createElement('p', { className: 'video-name' }, 'üîó /api/public - List public files'),
              React.createElement('p', { className: 'video-name' }, 'üîó /api/download-status - Download queue status'),
              React.createElement('p', { className: 'video-name' }, 'üîó /health - Server health')
            )
          )
        ),
        React.createElement('footer', {
          className: 'glass-bubble glow-effect compact-container',
          style: {
            textAlign: 'center',
            margin: '0.2rem',
            fontSize: '0.9rem',
            lineHeight: '1.4'
          }
        },
          React.createElement('div', { style: { marginBottom: '1rem' } },
            React.createElement('p', null, 'Built with ‚ù§Ô∏è using Express & React on port 6969'),
            React.createElement('p', { style: { fontSize: '0.8rem', opacity: '0.8', margin: '0.5rem 0' } },
              'By ', React.createElement('a', {
                href: 'https://github.com/HarleyVader',
                style: { color: 'var(--tertiary-alt)', textDecoration: 'none' },
                target: '_blank'
              }, 'HarleyVader'), ' - Creative software, AI & digital storytelling'
            )
          ),
          React.createElement('div', { style: { borderTop: '1px solid var(--glass-border)', paddingTop: '1rem', marginBottom: '1rem' } },
            React.createElement('p', { style: { fontSize: '0.8rem', marginBottom: '0.5rem', color: 'var(--primary-alt)' } }, 'üôè Special Thanks To:'),
            React.createElement('div', { style: { display: 'flex', justifyContent: 'center', gap: '1rem', flexWrap: 'wrap' } },
              React.createElement('a', {
                href: 'https://bambisleep.info',
                style: { color: 'var(--secondary-alt)', textDecoration: 'none', fontSize: '0.8rem' },
                target: '_blank'
              }, 'üìö BambiSleep Wiki'),
              React.createElement('a', {
                href: 'https://bambicloud.com',
                style: { color: 'var(--secondary-alt)', textDecoration: 'none', fontSize: '0.8rem' },
                target: '_blank'
              }, '‚òÅÔ∏è Bambi Cloud')
            )
          ),
          React.createElement('div', { style: { borderTop: '1px solid var(--glass-border)', paddingTop: '1rem' } },
            React.createElement('p', { style: { fontSize: '0.8rem', marginBottom: '0.5rem', color: 'var(--tertiary-alt)' } }, 'üöÄ Main Projects:'),
            React.createElement('div', { style: { display: 'flex', justifyContent: 'center', gap: '1rem', flexWrap: 'wrap' } },
              React.createElement('a', {
                href: 'https://bambisleep.chat',
                style: { color: 'var(--button-color)', textDecoration: 'none', fontSize: '0.8rem' },
                target: '_blank'
              }, 'ü§ñ BambiSleep.Chat - AI Hypnotic Girlfriend ‚Ä¢ Mind Control ‚Ä¢ Programming ‚Ä¢ Transformation ‚Ä¢ NSFW'),
              React.createElement('a', {
                href: 'https://bambisleep.church',
                style: { color: 'var(--button-color)', textDecoration: 'none', fontSize: '0.8rem' },
                target: '_blank'
              }, '‚õ™ BambiSleep.Church - Digital Sanctuary')
            )
          )
        )
      );
    }

    // Add CSS animation for loading spinner
    const style = document.createElement('style');
    style.textContent = `
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `;
    document.head.appendChild(style);

    // React 18 createRoot API
    const container = document.getElementById('root');
    const root = ReactDOM.createRoot(container);
    root.render(React.createElement(App));
  </script>
</body>

</html>